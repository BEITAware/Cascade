<UserControl x:Class="Cascade.Views.PlayerControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Cascade.Views"
             xmlns:vm="clr-namespace:Cascade.ViewModels"
             mc:Ignorable="d" 
             d:DesignHeight="100" d:DesignWidth="800">
    
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Cascade;component/Styles/PlayerStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>

    <!-- 播放器控制面板 -->
    <Grid Height="80" VerticalAlignment="Bottom">
        <!-- 背景 (高度60，位于底部) -->
        <Rectangle Fill="{StaticResource PlayerPanelBackgroundBrush}" Height="60" VerticalAlignment="Bottom"/>

        <!-- 布局 -->
        <Grid Margin="10,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="20"/> <!-- 进度条区域 (浮在背景上方) -->
                <RowDefinition Height="60"/> <!-- 按钮控制区域 (在背景上) -->
            </Grid.RowDefinitions>

            <!-- 进度条 -->
            <Grid Grid.Row="0" VerticalAlignment="Bottom" Margin="0,0,0,-5" Panel.ZIndex="1">
                <Slider Minimum="0"
                        Maximum="{Binding Duration}"
                        Value="{Binding Position}"
                        IsMoveToPointEnabled="True"/>
            </Grid>

            <!-- 按钮控制区 -->
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/> <!-- 左侧播放控制 -->
                    <ColumnDefinition Width="*"/>    <!-- 中间空白 -->
                    <ColumnDefinition Width="Auto"/> <!-- 右侧功能控制 -->
                </Grid.ColumnDefinitions>

                <!-- 左侧播放控制 -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <!-- 播放/暂停大按钮 -->
                    <Button Style="{StaticResource MainPlayButtonStyle}"
                            Command="{Binding PlayPauseCommand}"
                            Margin="0,0,15,0"
                            Width="48" Height="48">
                        <Button.Content>
                            <Binding Path="IsPlaying">
                                <Binding.Converter>
                                    <local:BoolToGeometryConverter TrueGeometry="{StaticResource IconPauseGeometry}" FalseGeometry="{StaticResource IconPlayGeometry}"/>
                                </Binding.Converter>
                            </Binding>
                        </Button.Content>
                    </Button>

                    <!-- 停止 -->
                    <Button Style="{StaticResource PlayerControlButtonStyle}"
                            Command="{Binding StopCommand}"
                            Content="{StaticResource IconStopGeometry}"
                            Margin="0,0,10,0"/>

                    <!-- 快退 -->
                    <Button Style="{StaticResource PlayerControlButtonStyle}"
                            Command="{Binding RewindCommand}"
                            Content="{StaticResource IconRewindGeometry}"
                            Margin="0,0,10,0"/>

                    <!-- 快进 -->
                    <Button Style="{StaticResource PlayerControlButtonStyle}"
                            Command="{Binding FastForwardCommand}"
                            Content="{StaticResource IconFastForwardGeometry}"
                            Margin="0,0,10,0"/>
                    
                    <!-- 下一个 -->
                    <Button Style="{StaticResource PlayerControlButtonStyle}"
                            Command="{Binding NextCommand}"
                            Content="{StaticResource IconNextGeometry}"/>
                </StackPanel>

                <!-- 右侧功能控制 -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <!-- 全屏 -->
                    <Button Style="{StaticResource PlayerControlButtonStyle}"
                            Command="{Binding ToggleFullScreenCommand}"
                            Content="{StaticResource IconFullScreenGeometry}"
                            Margin="0,0,15,0"/>

                    <!-- 分割线 -->
                    <Rectangle Width="1" Height="24" Fill="#40FFFFFF" Margin="0,0,15,0"/>

                    <!-- 音量 -->
                    <Button Style="{StaticResource PlayerControlButtonStyle}"
                            Command="{Binding MuteCommand}"
                            Content="{StaticResource IconVolumeGeometry}"
                            Margin="0,0,5,0"/>
                    
                    <!-- 音量滑块 -->
                    <Slider Width="80"
                            Minimum="0"
                            Maximum="1"
                            Value="{Binding Volume}"
                            LargeChange="0.1"
                            SmallChange="0.05"
                            VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Grid>
    </Grid>
</UserControl>
